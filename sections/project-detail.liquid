<section class="project-detail">
  {% assign screenshots = section.blocks | where: 'type', 'screenshot' %}

  <a href="/" class="btn back-to-portfolio">‚Üê Back to Projects</a>
  {% if screenshots.size > 0 %}
    <div class="carousel js-carousel">
      {% for block in screenshots %}
        <div class="carousel-cell">
          <img
            src="{{ block.settings.image | image_url: width: 800 }}"
            alt="{{ block.settings.image.alt | escape }}"
            width="auto"
            height="575"
          >
        </div>
      {% endfor %}
    </div>
  {% endif %}
  <h1 class="section-titles">&#123;% {{ page.title }} %&#125;</h1>
  <h1>Tech Stack</h1>
  <div class="tech-stack">
    {% for block in section.blocks %}
      {% if block.type == 'tech' and block.settings.category == 'frontend' %}
        <div class="tech-group">
          <h3>Frontend</h3>
          <div class="tech-list">
            {% for item in section.blocks %}
              {% if item.type == 'tech' and item.settings.category == 'frontend' %}
                <span class="tech-item">
                  <img
                    src="{{ item.settings.svg | image_url: width:50, height:50 }}"
                    width="24"
                    height="24"
                    alt="{{ item.settings.title }}"
                  >
                  <p>{{ item.settings.title }}</p>
                </span>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        {% break %}
      {% endif %}
    {% endfor %}

    {% for block in section.blocks %}
      {% if block.type == 'tech' and block.settings.category == 'backend' %}
        <div class="tech-group">
          <h3>Backend</h3>
          <div class="tech-list">
            {% for item in section.blocks %}
              {% if item.type == 'tech' and item.settings.category == 'backend' %}
                <span class="tech-item">
                  <img
                    src="{{ item.settings.svg | image_url: width:50, height:50 }}"
                    width="24"
                    height="24"
                    alt="{{ item.settings.title }}"
                  >
                  <p>{{ item.settings.title }}</p>
                </span>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        {% break %}
      {% endif %}
    {% endfor %}

    {% for block in section.blocks %}
      {% if block.type == 'tech' and block.settings.category == 'database' %}
        <div class="tech-group">
          <h3>Database</h3>
          <div class="tech-list">
            {% for item in section.blocks %}
              {% if item.type == 'tech' and item.settings.category == 'database' %}
                <span class="tech-item">
                  <img
                    src="{{ item.settings.svg | image_url: width:50, height:50 }}"
                    width="24"
                    height="24"
                    alt="{{ item.settings.title }}"
                  >
                  <p>{{ item.settings.title }}</p>
                </span>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        {% break %}
      {% endif %}
    {% endfor %}

    {% for block in section.blocks %}
      {% if block.type == 'tech' and block.settings.category == 'apis' %}
        <div class="tech-group">
          <h3>External APIs</h3>
          <div class="tech-list">
            {% for item in section.blocks %}
              {% if item.type == 'tech' and item.settings.category == 'apis' %}
                <span class="tech-item">
                  <img
                    src="{{ item.settings.svg | image_url: width:50, height:50 }}"
                    width="24"
                    height="24"
                    alt="{{ item.settings.title }}"
                  >
                  <p>{{ item.settings.title }}</p>
                </span>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        {% break %}
      {% endif %}
    {% endfor %}

    {% for block in section.blocks %}
      {% if block.type == 'tech' and block.settings.category == 'storage' %}
        <div class="tech-group">
          <h3>Storage</h3>
          <div class="tech-list">
            {% for item in section.blocks %}
              {% if item.type == 'tech' and item.settings.category == 'storage' %}
                <span class="tech-item">
                  <img
                    src="{{ item.settings.svg | image_url: width:50, height:50 }}"
                    width="24"
                    height="24"
                    alt="{{ item.settings.title }}"
                  >
                  <p>{{ item.settings.title }}</p>
                </span>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        {% break %}
      {% endif %}
    {% endfor %}
  </div>

  <div class="project-detail-content">
    {{ page.content }}
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var carousel = document.querySelector('.js-carousel');
    new Flickity(carousel, {
      cellAlign: 'center',
      freeScroll: true,
      wrapAround: true,
      autoPlay: false,
      pauseAutoPlayOnHover: true,
      pageDots: false,
      prevNextButtons: true,
      adaptiveHeight: true,
      cellSpacing: 40,
    });
  });
</script>

{% schema %}
{
  "name": "Project Detail",
  "settings": [],
  "blocks": [
    {
      "type": "screenshot",
      "name": "Screenshot",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Project Screenshot"
        }
      ]
    },
    {
      "type": "tech",
      "name": "Tech Stack Item",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Technology Name"
        },
        {
          "type": "select",
          "id": "category",
          "label": "Category",
          "options": [
            { "value": "frontend", "label": "Frontend" },
            { "value": "backend", "label": "Backend" },
            { "value": "database", "label": "Database" },
            { "value": "apis", "label": "External APIs" },
            { "value": "storage", "label": "Storage" }
          ]
        },
        {
          "type": "image_picker",
          "id": "svg",
          "label": "Skill SVG"
        }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Project Detail",
      "category": "Pages"
    }
  ]
}
{% endschema %}
